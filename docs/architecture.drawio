<mxfile host="app.diagrams.net" modified="2026-02-21T00:00:00.000Z" agent="Claude Code" version="24.0.0" type="device">
  <!-- ================================================================ -->
  <!-- TAB 1: HIGH-LEVEL ARCHITECTURE                                   -->
  <!-- ================================================================ -->
  <diagram id="arch" name="High-Level Architecture">
    <mxGraphModel dx="1422" dy="894" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- TITLE -->
        <mxCell id="title" value="Gremlin — High-Level Architecture" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=22;fontStyle=1;fontColor=#1a1a2e;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="v0.3.0 — CLI + Python API + Claude Code Agent" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="530" y="55" width="340" height="20" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- ENTRY POINTS                    -->
        <!-- =============================== -->
        <mxCell id="entry-group" value="Entry Points" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#6c5ce7;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#6c5ce7;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="130" y="90" width="1140" height="140" as="geometry" />
        </mxCell>

        <mxCell id="cli" value="&lt;b&gt;CLI&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;gremlin/cli.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Typer + Rich&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#ddd&quot;&gt;understand|ideate|rollout|judge&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="170" y="120" width="180" height="80" as="geometry" />
        </mxCell>

        <mxCell id="api" value="&lt;b&gt;Python API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;gremlin/api.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Gremlin class&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="410" y="125" width="180" height="70" as="geometry" />
        </mxCell>

        <mxCell id="agent" value="&lt;b&gt;Claude Code Agent&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;plugins/gremlin/agents/&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Code-review patterns&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="650" y="125" width="180" height="70" as="geometry" />
        </mxCell>

        <mxCell id="cicd" value="&lt;b&gt;CI/CD Integration&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;JUnit XML / JSON&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Exit codes&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="890" y="125" width="180" height="70" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- CORE ENGINE                     -->
        <!-- =============================== -->
        <mxCell id="core-group" value="Core Engine  (gremlin/core/ · stages.py)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#00b894;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#00b894;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="130" y="280" width="860" height="195" as="geometry" />
        </mxCell>

        <mxCell id="inference" value="&lt;b&gt;Domain Inference&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;inference.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Keyword → Domain&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00b894;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="155" y="315" width="180" height="70" as="geometry" />
        </mxCell>

        <mxCell id="patterns-node" value="&lt;b&gt;Pattern Selection&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;patterns.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Universal + Domain&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00b894;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="375" y="315" width="180" height="70" as="geometry" />
        </mxCell>

        <mxCell id="prompts" value="&lt;b&gt;Prompt Builder&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;prompts.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;System + User msg&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00b894;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="595" y="315" width="180" height="70" as="geometry" />
        </mxCell>

        <mxCell id="validator" value="&lt;b&gt;Validator&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;validator.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;2nd-pass filter&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#55efc4;fontColor=#2d3436;strokeColor=#00b894;strokeWidth=1;arcSize=20;shadow=1;dashed=1;dashPattern=8 8;" vertex="1" parent="1">
          <mxGeometry x="800" y="320" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="stages-node" value="&lt;b&gt;stages.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;UnderstandingResult · IdeationResult&lt;br&gt;RolloutResult · JudgmentResult&lt;br&gt;&lt;font color=&quot;#555&quot;&gt;(frozen dataclasses — v0.3)&lt;/font&gt;&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=10;fillColor=#d5f5e3;strokeColor=#00b894;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="155" y="400" width="220" height="60" as="geometry" />
        </mxCell>

        <!-- Core arrows -->
        <mxCell id="e1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#00b894;strokeWidth=2;" edge="1" source="inference" target="patterns-node" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#00b894;strokeWidth=2;" edge="1" source="patterns-node" target="prompts" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#00b894;strokeWidth=2;dashed=1;" edge="1" source="prompts" target="validator" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- PATTERN STORE                   -->
        <!-- =============================== -->
        <mxCell id="store-group" value="Pattern Store  (107 patterns, 14 domains)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#fdcb6e;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#d4a017;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="130" y="530" width="400" height="190" as="geometry" />
        </mxCell>

        <mxCell id="breaking" value="&lt;b&gt;breaking.yaml&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;14 domains + universal&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;payments, auth, files,&lt;br&gt;database, api, search,&lt;br&gt;security, serialization,&lt;br&gt;distributed ...&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=15;fillColor=#ffeaa7;strokeColor=#d4a017;shadow=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="150" y="570" width="160" height="130" as="geometry" />
        </mxCell>

        <mxCell id="incidents" value="&lt;b&gt;incidents/*.yaml&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Learned from&lt;br&gt;real incidents&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#999&quot;&gt;via gremlin learn&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=15;fillColor=#ffeaa7;strokeColor=#d4a017;shadow=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="340" y="570" width="160" height="130" as="geometry" />
        </mxCell>

        <mxCell id="e-store" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d4a017;strokeWidth=2;" edge="1" source="breaking" target="patterns-node" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="230" y="550" />
              <mxPoint x="465" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- =============================== -->
        <!-- LLM LAYER                       -->
        <!-- =============================== -->
        <mxCell id="llm-group" value="LLM Layer  (gremlin/llm/)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#e17055;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#e17055;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="590" y="530" width="400" height="190" as="geometry" />
        </mxCell>

        <mxCell id="factory" value="&lt;b&gt;Provider Factory&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;factory.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Registry pattern&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e17055;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="570" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="anthropic" value="&lt;b&gt;Anthropic&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Claude Sonnet 4&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fab1a0;fontColor=#2d3436;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="650" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="openai-p" value="&lt;b&gt;OpenAI&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;GPT-4&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffeaa7;fontColor=#2d3436;strokeColor=#e17055;strokeWidth=1;arcSize=20;shadow=1;dashed=1;dashPattern=5 5;" vertex="1" parent="1">
          <mxGeometry x="740" y="650" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ollama-p" value="&lt;b&gt;Ollama&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Local LLMs&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffeaa7;fontColor=#2d3436;strokeColor=#e17055;strokeWidth=1;arcSize=20;shadow=1;dashed=1;dashPattern=5 5;" vertex="1" parent="1">
          <mxGeometry x="860" y="650" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="ef1" style="rounded=1;strokeColor=#e17055;strokeWidth=1.5;" edge="1" source="factory" target="anthropic" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ef2" style="rounded=1;strokeColor=#e17055;strokeWidth=1.5;dashed=1;" edge="1" source="factory" target="openai-p" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ef3" style="rounded=1;strokeColor=#e17055;strokeWidth=1.5;dashed=1;" edge="1" source="factory" target="ollama-p" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="e-prm-fac" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="prompts" target="factory" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="685" y="500" />
              <mxPoint x="700" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- =============================== -->
        <!-- OUTPUT LAYER                    -->
        <!-- =============================== -->
        <mxCell id="output-group" value="Output Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#0984e3;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#0984e3;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="130" y="775" width="860" height="130" as="geometry" />
        </mxCell>

        <mxCell id="parser" value="&lt;b&gt;Risk Parser&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;api.py:_parse_risks&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;MD → Risk objects&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="155" y="810" width="170" height="70" as="geometry" />
        </mxCell>

        <mxCell id="renderer" value="&lt;b&gt;Renderer&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;output/renderer.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Rich / Markdown / JSON&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="375" y="810" width="170" height="70" as="geometry" />
        </mxCell>

        <mxCell id="structured" value="&lt;b&gt;Structured Output&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;AnalysisResult&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;JSON / JUnit / LLM fmt&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="595" y="810" width="170" height="70" as="geometry" />
        </mxCell>

        <mxCell id="bridge" value="&lt;b&gt;Agent Bridge&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#ccc&quot;&gt;integrations/&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;CLI ↔ Agent&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="800" y="810" width="160" height="70" as="geometry" />
        </mxCell>

        <mxCell id="eo1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#0984e3;strokeWidth=2;" edge="1" source="parser" target="renderer" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="eo2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#0984e3;strokeWidth=2;" edge="1" source="parser" target="structured" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- LLM → Parser -->
        <mxCell id="e-llm-par" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="factory" target="parser" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="700" y="755" />
              <mxPoint x="240" y="755" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="lbl-resp" value="LLM Response (Markdown)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#636e72;" vertex="1" parent="1">
          <mxGeometry x="380" y="737" width="150" height="20" as="geometry" />
        </mxCell>

        <!-- Entry → Core -->
        <mxCell id="ec1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="cli" target="inference" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="255" />
              <mxPoint x="245" y="255" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ec2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="api" target="inference" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="255" />
              <mxPoint x="245" y="255" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- =============================== -->
        <!-- EVAL & TESTING                  -->
        <!-- =============================== -->
        <mxCell id="eval-group" value="Eval &amp; Testing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#a29bfe;strokeWidth=2;dashed=1;fontSize=11;fontStyle=1;fontColor=#a29bfe;verticalAlign=top;spacingTop=2;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="1060" y="280" width="200" height="430" as="geometry" />
        </mxCell>

        <mxCell id="eval-runner" value="&lt;b&gt;Eval Runner&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;evals/run_eval.py&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;A/B Gremlin vs Claude&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a29bfe;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1080" y="320" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="eval-cases" value="&lt;b&gt;Test Cases&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;54 real-world YAML&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;evals/cases/&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=15;fillColor=#dfe6e9;strokeColor=#a29bfe;shadow=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1080" y="405" width="160" height="70" as="geometry" />
        </mxCell>

        <mxCell id="critiques" value="&lt;b&gt;Critiques&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;httpx, pydantic,&lt;br&gt;celery validation&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;evals/critiques/&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=15;fillColor=#dfe6e9;strokeColor=#a29bfe;shadow=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1080" y="500" width="160" height="80" as="geometry" />
        </mxCell>

        <mxCell id="ci" value="&lt;b&gt;CI Pipeline&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;GitHub Actions&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;pytest + ruff + coverage&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a29bfe;fontColor=#ffffff;strokeColor=none;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1080" y="605" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="golden-eval" value="&lt;b&gt;Golden Set Recall&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#999&quot;&gt;*-results.json&lt;br&gt;(v0.3 stage artifacts)&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=10;fillColor=#e8d5ff;strokeColor=#a29bfe;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1080" y="690" width="160" height="55" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- EXTERNAL: Anthropic API cloud   -->
        <!-- =============================== -->
        <mxCell id="anthropic-api" value="&lt;b&gt;Anthropic API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;claude-sonnet-4&lt;/font&gt;" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffeaa7;strokeColor=#d4a017;shadow=1;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="1060" y="110" width="200" height="90" as="geometry" />
        </mxCell>

        <mxCell id="e-ext" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d4a017;strokeWidth=2;dashed=1;" edge="1" source="anthropic" target="anthropic-api" parent="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="670" y="730" />
              <mxPoint x="1040" y="730" />
              <mxPoint x="1040" y="155" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- =============================== -->
        <!-- LEGEND                          -->
        <!-- =============================== -->
        <mxCell id="legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f9fa;strokeColor=#dfe6e9;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="1060" y="775" width="210" height="130" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1070" y="780" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ls1" value="" style="endArrow=classic;html=1;strokeColor=#636e72;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1075" y="813" as="sourcePoint" />
            <mxPoint x="1120" y="813" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ls1l" value="Data flow" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1125" y="803" width="65" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ls2" value="" style="endArrow=classic;html=1;strokeColor=#636e72;strokeWidth=2;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1075" y="835" as="sourcePoint" />
            <mxPoint x="1120" y="835" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ls2l" value="Optional / Planned" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1125" y="825" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ls3" value="" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=10;fillColor=#ffeaa7;strokeColor=#d4a017;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1075" y="855" width="35" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ls3l" value="Static data file" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1125" y="850" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ls4" value="" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffeaa7;strokeColor=#d4a017;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1072" y="878" width="40" height="22" as="geometry" />
        </mxCell>
        <mxCell id="ls4l" value="External API" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1125" y="875" width="80" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <!-- ================================================================ -->
  <!-- TAB 2: DATA FLOW (v0.3 — simplified pipeline view)              -->
  <!-- ================================================================ -->
  <diagram id="dataflow" name="Data Flow">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1500" pageHeight="600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- TITLE -->
        <mxCell id="df-title" value="Gremlin — Pipeline Data Flow" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=22;fontStyle=1;fontColor=#1a1a2e;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="df-subtitle" value="v0.3 — four named stages, each reads the previous artifact and writes its own" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="400" y="55" width="550" height="20" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- USER INPUT                      -->
        <!-- =============================== -->
        <mxCell id="user-input" value="&lt;b&gt;User Input&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;scope + context&lt;br&gt;depth · threshold&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;fontColor=#ffffff;strokeColor=none;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="130" width="150" height="80" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- STAGE 1: UNDERSTANDING          -->
        <!-- =============================== -->
        <mxCell id="stage1" value="&lt;b&gt;① Understanding&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Infer domains from&lt;br&gt;scope keywords&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#ccc&quot;&gt;inference.py&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00b894;fontColor=#ffffff;strokeColor=none;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="280" y="120" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="art1" value="&lt;font style=&quot;font-size:9px&quot;&gt;understanding.json&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5f5e3;strokeColor=#00b894;fontSize=9;fontColor=#2d3436;" vertex="1" parent="1">
          <mxGeometry x="290" y="230" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- STAGE 2: IDEATION               -->
        <!-- =============================== -->
        <mxCell id="stage2" value="&lt;b&gt;② Ideation&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Select universal +&lt;br&gt;domain patterns&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#ccc&quot;&gt;patterns.py&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fdcb6e;fontColor=#2d3436;strokeColor=none;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="120" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="art2" value="&lt;font style=&quot;font-size:9px&quot;&gt;scenarios.json&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffeaa7;strokeColor=#d4a017;fontSize=9;fontColor=#2d3436;" vertex="1" parent="1">
          <mxGeometry x="530" y="230" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- STAGE 3: ROLLOUT                -->
        <!-- =============================== -->
        <mxCell id="stage3" value="&lt;b&gt;③ Rollout&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Build prompt +&lt;br&gt;call LLM&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#ccc&quot;&gt;prompts.py + llm/&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e17055;fontColor=#ffffff;strokeColor=none;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="760" y="120" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="art3" value="&lt;font style=&quot;font-size:9px&quot;&gt;results.json&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fab1a0;strokeColor=#e17055;fontSize=9;fontColor=#2d3436;" vertex="1" parent="1">
          <mxGeometry x="770" y="230" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- STAGE 4: JUDGMENT               -->
        <!-- =============================== -->
        <mxCell id="stage4" value="&lt;b&gt;④ Judgment&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Parse risks +&lt;br&gt;score severity&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#ccc&quot;&gt;api.py:_parse_risks&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;fontColor=#ffffff;strokeColor=none;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1000" y="120" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="art4" value="&lt;font style=&quot;font-size:9px&quot;&gt;scores.json&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#74b9ff;strokeColor=#0984e3;fontSize=9;fontColor=#2d3436;" vertex="1" parent="1">
          <mxGeometry x="1010" y="230" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- OUTPUT                          -->
        <!-- =============================== -->
        <mxCell id="output" value="&lt;b&gt;Output&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;AnalysisResult&lt;br&gt;JSON · JUnit · Rich&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#74b9ff;fontColor=#2d3436;strokeColor=#0984e3;arcSize=15;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1250" y="130" width="160" height="80" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- MAIN PIPELINE ARROWS            -->
        <!-- =============================== -->
        <mxCell id="ea1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="user-input" target="stage1" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ea2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="stage1" target="stage2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ea3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="stage2" target="stage3" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ea4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="stage3" target="stage4" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ea5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#636e72;strokeWidth=2;" edge="1" source="stage4" target="output" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- ANTHROPIC API (below Rollout)   -->
        <!-- =============================== -->
        <mxCell id="llm-cloud" value="&lt;b&gt;Anthropic API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;claude-sonnet-4&lt;/font&gt;" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffeaa7;strokeColor=#d4a017;shadow=1;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="760" y="310" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ea-llm" style="rounded=1;strokeColor=#d4a017;strokeWidth=2;" edge="1" source="stage3" target="llm-cloud" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- PATTERN STORE (below Ideation)  -->
        <!-- =============================== -->
        <mxCell id="patterns-store" value="&lt;b&gt;107 Patterns&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;14 domains&lt;br&gt;breaking.yaml + incidents&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=12;fillColor=#ffeaa7;strokeColor=#d4a017;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="530" y="310" width="150" height="65" as="geometry" />
        </mxCell>
        <mxCell id="ea-pat" style="rounded=1;strokeColor=#d4a017;strokeWidth=2;" edge="1" source="patterns-store" target="stage2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- OPTIONAL VALIDATION             -->
        <!-- =============================== -->
        <mxCell id="val-pass" value="&lt;b&gt;--validate&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;2nd LLM pass&lt;br&gt;filters hallucinations&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#55efc4;fontColor=#2d3436;strokeColor=#00b894;strokeWidth=1;arcSize=15;shadow=1;dashed=1;dashPattern=8 8;" vertex="1" parent="1">
          <mxGeometry x="1010" y="315" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="ea-val" style="rounded=1;strokeColor=#00b894;strokeWidth=2;dashed=1;" edge="1" source="stage4" target="val-pass" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- FROZEN DATACLASSES NOTE         -->
        <!-- =============================== -->
        <mxCell id="frozen-note" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#636e72&quot;&gt;Each stage produces a &lt;b&gt;frozen dataclass&lt;/b&gt; (stages.py) written atomically to &lt;b&gt;.gremlin/run/&lt;/b&gt;&lt;br&gt;Pipeline: UnderstandingResult → IdeationResult → RolloutResult → JudgmentResult&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];strokeColor=none;fillColor=none;fontSize=9;fontColor=#636e72;" vertex="1" parent="1">
          <mxGeometry x="250" y="270" width="500" height="30" as="geometry" />
        </mxCell>

        <!-- =============================== -->
        <!-- LEGEND                          -->
        <!-- =============================== -->
        <mxCell id="df-legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f9fa;strokeColor=#dfe6e9;arcSize=12;" vertex="1" parent="1">
          <mxGeometry x="60" y="430" width="680" height="50" as="geometry" />
        </mxCell>
        <mxCell id="lg1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c5ce7;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="75" y="445" width="20" height="12" as="geometry" />
        </mxCell>
        <mxCell id="lg1l" value="Input" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="98" y="440" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00b894;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="145" y="445" width="20" height="12" as="geometry" />
        </mxCell>
        <mxCell id="lg2l" value="Understanding" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="168" y="440" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fdcb6e;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="265" y="445" width="20" height="12" as="geometry" />
        </mxCell>
        <mxCell id="lg3l" value="Ideation" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="288" y="440" width="55" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e17055;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="350" y="445" width="20" height="12" as="geometry" />
        </mxCell>
        <mxCell id="lg4l" value="Rollout" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="373" y="440" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0984e3;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="430" y="445" width="20" height="12" as="geometry" />
        </mxCell>
        <mxCell id="lg5l" value="Judgment" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="453" y="440" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg6" value="" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffeaa7;strokeColor=#d4a017;" vertex="1" parent="1">
          <mxGeometry x="520" y="442" width="30" height="18" as="geometry" />
        </mxCell>
        <mxCell id="lg6l" value="External API" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="553" y="440" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lg7" value="" style="endArrow=classic;html=1;strokeColor=#636e72;strokeWidth=2;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="645" y="451" as="sourcePoint" />
            <mxPoint x="680" y="451" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lg7l" value="Optional" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="685" y="440" width="55" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
